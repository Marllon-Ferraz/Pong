<meta charset="utf-8">

<script src="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.js"></script>

<script>

  //variáveis da bolinha
  let xBolinha = 10;
  let yBolinha = 10;
  let diametro = 24;
  let raio = diametro / 2;

  //velocidade da bolinha
  let velocidadeXBolinha = 7;
  let velocidadeYBolinha = 7;

  //variáveis da minhaRaquete
  let xMinhaRaquete = 5;
  let yMinhaRaquete = 150;

  //tamanho raquete
  let larguraRaquete = 12;
  let alturaRaquete = 85;

  //variáveis da oponenteRaquete
  let xOponenteRaquete = 580;
  let yOponenteRaquete = 150;
  let velocidadeYOponente;

  //palcar do jogo
  let meusPontos = 0;
  let pontosOponente = 0;

  //sons do jogo
  let raquetada;
  let ponto;
  let trilha;

  function preload() {
    trilha = loadSound("partida.wav");
    raquetada = loadSound("raquetada.wav");
    ponto = loadSound("ponto.wav");
  }

  function setup() {
    createCanvas(600, 400);
    trilha.loop();
  }

  function draw() {
    background(180, 0, 0);
    mostraBolinha();
    movimentaBolinha();
    verificaColisaoBorda();
    minhaRaquete();
    movimentaMinhaRaquete();
    verificaColisaoMinhaRaquete();
    oponenteRaquete();
    //movimentaOponenteRaquete();
    movimentaAutoRaqueteOponente();
    verificaColisaoRaqueteOponente();
    incluiPlacar();
    marcaPonto();

  }

  function mostraBolinha() {
    fill(255, 190, 0);
    circle(xBolinha, yBolinha, diametro);
  }

  function movimentaBolinha() {
    xBolinha += velocidadeXBolinha;
    yBolinha += velocidadeYBolinha;
  }

  function verificaColisaoBorda() {
    if (xBolinha + raio > width || xBolinha - raio < 0) {
      velocidadeXBolinha *= -1;
    }

    if (yBolinha + raio > height || yBolinha - raio < 0) {
      velocidadeYBolinha *= -1;
    }
  }

  function minhaRaquete(x, y) {
    fill(14, 252, 254);
    rect(xMinhaRaquete, yMinhaRaquete, larguraRaquete, alturaRaquete);
  }

  function oponenteRaquete() {
    fill(0, 180, 0);
    rect(xOponenteRaquete, yOponenteRaquete, larguraRaquete, alturaRaquete);
  }

  function movimentaMinhaRaquete() {
    if (keyIsDown(81)) {
      yMinhaRaquete -= 10;
    }
    if (keyIsDown(65)) {
      yMinhaRaquete += 10;
    }
  }

  function movimentaOponenteRaquete() {
    if (keyIsDown(UP_ARROW)) {
      yOponenteRaquete -= 10;
    }
    if (keyIsDown(DOWN_ARROW)) {
      yOponenteRaquete += 10;
    }
  }

  function movimentaAutoRaqueteOponente() {
    velocidadeYOponente = yBolinha - yOponenteRaquete - larguraRaquete / 2 - 30;
    yOponenteRaquete += velocidadeYOponente;
  }

  function verificaColisaoMinhaRaquete() {
    if (xBolinha - raio < xMinhaRaquete + larguraRaquete && yBolinha - raio < yMinhaRaquete + alturaRaquete && yBolinha + raio > yMinhaRaquete) {
      velocidadeXBolinha *= -1;
      raquetada.play();
    }
  }

  function verificaColisaoRaqueteOponente() {
    if (xBolinha + raio > xOponenteRaquete && yBolinha - raio < yOponenteRaquete + alturaRaquete && yBolinha + raio > yOponenteRaquete) {
      velocidadeXBolinha *= -1;
      raquetada.play();
    }
  }

  function incluiPlacar() {
    fill(180, 0, 0);
    rect(150, 10, 40, 25);
    stroke(255, 190, 0);
    fill(255, 190, 0);
    textSize(22);
    text(meusPontos, 164, 30);
    fill(180, 0, 0);
    rect(450, 10, 40, 25);
    stroke(255, 190, 0);
    fill(255, 190, 0);
    textSize(23);
    text(pontosOponente, 464, 30);
  }

  function marcaPonto() {
    if (xBolinha > 585) {
      meusPontos += 1;
      ponto.play();
    }
    if (xBolinha < 15) {
      pontosOponente += 1;
      ponto.play();
    }
  }

</script>